<!DOCTYPE html>
<html>
	<head>
		<title>Bounce-ball Demo</title>
		<meta http-equiv="content-type" content="text/html; charset=utf-8">

		<!-- The following meta line optimizes the site for mobile devices. It sets the viewport size
		to the screen size, so it will be displayed maximized, but unscaled. -->
		<meta name="viewport" content="width=device-width, height=device-height, initial-scale=1">
        <link rel="stylesheet" type="text/css" href="../css/NEHE.css" />

		<!-- Include the necessary libs -->
		<script src="../js/three.js" type="text/javascript"></script>
		<script src="../js/Detector.js" type="text/javascript"></script>
        <script src="../js/OrbitControls-Touch.js" type="text/javascript"></script>
        <script src="../js/gfx-scene.js" type="text/javascript"></script>
	</head>
	<body>

		<script type="text/javascript">
            // allocate the Scene object, and set the camera position
            var gfxScene = new GFX.Scene( { cameraPos:[0,6,6],
                                            controls:true,
                                            floorRepeat:10});
            // globals
            var sphere;
            var veloc   = new THREE.Vector3(0.01, 0.1, 0.01);
            var gravity = new THREE.Vector3(0, -0.001, 0);
            var loc     = new THREE.Vector3(0, 0, 0);
			// Initialize the demo
			initializeDemo();

			// Animate the scene
			animateScene();

			/**
			 *  Initialize the demo's local aspects, i.e not the scene.
			 */
			function initializeDemo() {

                var geometry = new THREE.SphereGeometry( 0.1, 32, 32 );
                var material = new THREE.MeshLambertMaterial( {color: 0xffff00} );
                sphere = new THREE.Mesh( geometry, material );
                sphere.position.set(0, 0.1, 0);
                gfxScene.add( sphere );
			}

			/**
			 * Animate the scene and call rendering.
			 */
			function animateScene() {

                loc.add(veloc);
                veloc.add(gravity);
                sphere.position.set(loc.x, loc.y, loc.z);

                if (loc.y < 0.0) {
                    veloc.y = -veloc.y * 0.75;
                }

                console.log(" veloc: " + veloc.x.toFixed(3) + ", " + veloc.y.toFixed(3) + ", " + veloc.z.toFixed(3) + ", loc: " + loc.x.toFixed(3) + ", " + loc.y.toFixed(3) + ", "+ loc.z.toFixed(3));

				// Tell the browser to call this function back
				requestAnimationFrame(animateScene);

                // Map the 3D scene down to the 2D screen (render the frame)
                gfxScene.renderScene();
			}

		</script>
	</body>
</html>
